<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>AFTRACK Movil</title>
    <base href="/" />

    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="css/alfacross.css" />
    <link rel="stylesheet" href="css/site.css" />
    <link rel="stylesheet" href="CrossBoxApp.styles.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="imagenes/Rhino.png" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#0d0d0d" />
    <link rel="icon" href="data:,">
</head>

<body>

    <div class="status-bar-safe-area"></div>

    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>

    <script src="_framework/blazor.webview.js" autostart="false"></script>
    <script>
        window.audioContext = null;

        // FunciÃ³n para desbloquear el audio en iOS
        window.prepararAudio = () => {
            const audios = ['audio-beep', 'audio-go', 'audio-medio'];

            audios.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    // Truco para iOS: forzar carga y play/pause silencioso
                    el.load();
                    el.muted = true; // Importante para que deje reproducir sin user gesture la primera vez
                    const promise = el.play();

                    if (promise !== undefined) {
                        promise.then(_ => {
                            el.pause();
                            el.currentTime = 0;
                            el.muted = false; // Quitamos el mute para cuando lo necesitemos real
                        }).catch(error => {
                            console.log("Autoplay bloqueado (normal hasta click):", error);
                        });
                    }
                }
            });
        };

        window.reproducirSonido = (id) => {
            const audio = document.getElementById(id);
            if (audio) {
                audio.currentTime = 0;
                // Aseguramos volumen al 100%
                audio.volume = 1.0;
                audio.play().catch(e => console.log("Error reproduciendo: " + id, e));
            }
        };
    </script>
</body>

</html>